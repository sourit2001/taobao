# 淘宝抢购助手 (Taobao Flash Sale Helper)

一个带有图形用户界面（GUI）的Python脚本，旨在帮助用户自动化淘宝/天猫的限时抢购流程。

## 项目简介

本工具通过Selenium控制Chrome浏览器，在用户预设的时间自动点击“结算”和“提交订单”按钮，提高抢购成功率。用户只需提前登录淘宝账户，将商品加入购物车并保持在购物车页面或结算页面，工具将在指定时间执行抢购操作。

## 主要功能

*   **图形用户界面 (GUI)**：使用Tkinter构建，操作直观方便。
*   **自动化浏览器操作**：自动启动和控制Chrome浏览器。
*   **用户手动准备**：支持用户手动登录淘宝账户、选择商品并导航到购物车。
*   **定时抢购**：精确到毫秒级的时间设定，在指定时间自动执行点击。
*   **两步点击**：自动依次点击“结算”按钮和“提交订单”按钮。
*   **实时倒计时**：界面显示醒目的红色倒计时，方便用户掌握剩余时间。
*   **操作日志**：实时显示程序运行状态和关键操作日志。
*   **现代界面风格**：简洁明亮的界面设计，提升用户体验。
*   **鲁棒的点击逻辑**：
    *   自动滚动元素到可见区域。
    *   模拟鼠标悬停。
    *   优先尝试标准Selenium点击，失败则回退到JavaScript点击。
*   **错误处理与调试**：在关键步骤点击失败时，会自动保存当前页面源码 (`checkout_page_source.html` 或 `submit_page_source.html`) 到项目根目录，方便定位问题和更新XPath。
*   **便捷退出**：提供“关闭窗口”按钮，一键退出程序并关闭由脚本启动的浏览器。

## 技术栈

*   **Python 3**: 主要编程语言
*   **Tkinter**: 用于构建图形用户界面
*   **Selenium**: 用于浏览器自动化

## 环境准备与安装

在开始之前，请确保您的系统已安装以下软件：

1.  **Python 3.x**: [下载Python](https://www.python.org/downloads/)
2.  **Google Chrome 浏览器**: [下载Chrome](https://www.google.com/chrome/)
3.  **ChromeDriver**:
    *   版本必须与您安装的Google Chrome浏览器版本完全对应。
    *   查看Chrome版本：在Chrome地址栏输入 `chrome://version`。
    *   [下载ChromeDriver](https://chromedriver.chromium.org/downloads)
    *   下载后，请将 `chromedriver` 可执行文件放置到项目根目录下的 `chromedriver` 文件夹内 (例如：`/path/to/project/chromedriver/chromedriver`)。

### 安装步骤

1.  **克隆仓库**:
    ```bash
    git clone https://github.com/sourit2001/taobao.git
    cd taobao
    ```

2.  **安装Python依赖**:
    建议使用虚拟环境。
    ```bash
    python3 -m venv venv
    source venv/bin/activate  # macOS/Linux
    # venv\Scripts\activate  # Windows
    ```
    安装所需的库：
    ```bash
    pip install selenium requests
    ```
    (或者，如果项目包含 `requirements.txt` 文件: `pip install -r requirements.txt`)

3.  **配置ChromeDriver路径**:
    打开 `taobao_qg_gui.py` 文件，找到以下行：
    ```python
    CHROME_DRIVER_PATH = "/Users/lizhu/Downloads/CCR/taobao/chromedriver/chromedriver" # macOS示例
    # CHROME_DRIVER_PATH = "D:\\path\\to\\chromedriver\\chromedriver.exe" # Windows示例
    ```
    请根据您实际存放 `chromedriver` 的路径修改此变量。**确保路径正确无误。**

## 使用步骤

1.  **启动程序**:
    在项目根目录下运行脚本：
    ```bash
    python3 taobao_qg_gui.py
    ```

2.  **第一步：准备浏览器**:
    *   点击GUI上的“**打开浏览器并手动准备**”按钮。
    *   一个新的Chrome浏览器窗口将会打开。
    *   **手动操作**：
        1.  登录您的淘宝账户。
        2.  导航到您的购物车页面。
        3.  勾选您想要抢购的商品。
        4.  **重要**: 请确保最终停留在购物车页面或已进入到“确认订单”页面（即点击“结算”后的页面）。脚本会根据当前页面情况尝试点击“结算”或“提交订单”。

3.  **第二步：设置时间并抢购**:
    *   回到“淘宝抢购助手”的GUI窗口。
    *   在“**抢购时间 (HH:MM:SS.fff)**”输入框中，设置您期望开始抢购的具体时间。
        *   格式为：时:分:秒.毫秒 (例如: `22:30:00.500` 表示晚上10点30分0秒500毫秒)。
        *   请确保此时间略早于商品实际开售时间，以抵消网络延迟。
    *   点击“**开始倒计时抢购**”按钮。

4.  **监控与等待**:
    *   界面上的倒计时将开始，并以红色字体显示剩余时间。
    *   日志区域会显示程序状态。
    *   到达设定时间后，脚本会自动尝试点击“结算”（如果在购物车页面）和“提交订单”（如果在确认订单页面）。

5.  **完成/退出**:
    *   抢购完成后，您可以手动关闭浏览器和程序。
    *   或者点击GUI底部的“**关闭窗口**”按钮，程序将安全退出并关闭由它启动的浏览器。

## 注意事项

*   **网络延迟**: 请确保您的网络连接稳定，并将抢购时间设置得比官方开始时间早几百毫秒到1秒，以应对可能的网络和系统延迟。
*   **系统时间**: 确保您的电脑系统时间与北京时间同步且准确。
*   **淘宝页面结构变化**: 淘宝/天猫的网页结构可能会不定期更新，这可能导致脚本中的元素定位符（XPath）失效。如果脚本无法点击按钮，请检查项目根目录下是否生成了 `checkout_page_source.html` 或 `submit_page_source.html` 文件。您可能需要根据这些文件内容，更新 `taobao_qg_gui.py` 中的XPath表达式。
*   **验证码与风控**: 对于需要输入验证码或遇到淘宝风控系统拦截的情况，本脚本目前无法自动处理。
*   **多账号/多商品**: 当前版本主要针对单一账号和预先在购物车选好的商品。
*   **成功率**: 本工具不能保证100%抢购成功，成功与否受多种因素影响（如商品库存、网络状况、服务器压力、淘宝风控策略等）。

## 免责声明

*   本脚本仅供学习和研究自动化技术使用，请勿用于非法用途或商业牟利。
*   用户使用本脚本所造成的一切后果，由用户自行承担。开发者不对任何直接或间接的损失负责。
*   请遵守淘宝/天猫平台的用户协议和相关规定。

## 未来展望 (可选)

*   [ ] 优化XPath定位，提高对页面变化的适应性。
*   [ ] 增加对验证码的人工辅助处理或尝试简单OCR识别。
*   [ ] 支持多商品并发抢购配置。
*   [ ] 配置文件支持，避免硬编码路径等。

---

祝您抢购顺利！